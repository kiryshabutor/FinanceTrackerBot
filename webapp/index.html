<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Tracker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="/webapp/assets/css/style.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="avatar">üë§</div>
                <div class="user-info">
                    <h3 id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>
                    <p id="userTelegramId">@username</p>
                </div>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="menu-link active" data-tab="home">
                    <span class="icon">üè†</span>
                    <span>–ì–ª–∞–≤–Ω–∞—è</span>
                </a></li>
                <li><a href="#" class="menu-link" data-tab="accounts">
                    <span class="icon">üí≥</span>
                    <span>–°—á–µ—Ç–∞</span>
                </a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="header">
                <button class="menu-button" id="menuButton">‚ò∞</button>
                <h1 class="header-title" id="pageTitle">–ì–ª–∞–≤–Ω–∞—è</h1>
                <div style="width: 40px;"></div>
            </div>

            <!-- Home Tab -->
            <div class="tab-content active" id="homeTab">
                <!-- Balance Card -->
                <div class="balance-card">
                    <div class="balance-header">
                        <span class="balance-label">–ë–∞–ª–∞–Ω—Å</span>
                        <select class="account-selector" id="balanceAccountSelect">
                            <option value="all">–í—Å–µ —Å—á–µ—Ç–∞</option>
                        </select>
                    </div>
                    <div class="balance-amount" id="balanceAmount">0 ‚ÇΩ</div>
                </div>

                <!-- Type Selector -->
                <div class="type-selector">
                    <button class="type-button active" data-type="expense">–†–∞—Å—Ö–æ–¥—ã</button>
                    <button class="type-button" data-type="income">–î–æ—Ö–æ–¥—ã</button>
                </div>


                <!-- Summary Card -->
                <div class="summary-card">
                    <div class="summary-label" id="summaryLabel">–†–∞—Å—Ö–æ–¥—ã –∑–∞ –ø–µ—Ä–∏–æ–¥</div>
                    <div class="summary-amount" id="summaryAmount">0 ‚ÇΩ</div>
                </div>

                <!-- Transactions List -->
                <ul class="transactions-list" id="transactionsList">
                    <li class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</li>
                </ul>
            </div>

            <!-- Accounts Tab -->
            <div class="tab-content" id="accountsTab">
                <!-- Accounts Summary -->
                <div class="accounts-summary">
                    <div class="accounts-summary-label">–ò—Ç–æ–≥–æ –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º</div>
                    <div class="accounts-summary-amount" id="totalBalance">0 ‚ÇΩ</div>
                </div>

                <!-- Actions -->
                <div class="accounts-actions">
                    <button class="action-button" id="transferHistoryBtn">–ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤</button>
                    <button class="action-button" id="transferBtn">–ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏</button>
                </div>

                <!-- Accounts List -->
                <ul class="accounts-list" id="accountsList">
                    <li class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</li>
                </ul>

                <!-- Add Account Button -->
                <button class="submit-button" id="addAccountBtn" style="margin-top: 20px;">+ –î–æ–±–∞–≤–∏—Ç—å —Å—á–µ—Ç</button>
            </div>
        </main>
    </div>

    <!-- Transaction Form Modal -->
    <div class="modal" id="transactionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="transactionModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
                <button class="close-button" onclick="closeModal('transactionModal')">√ó</button>
            </div>
            <form id="transactionForm" novalidate>
                <div class="form-group">
                    <label class="form-label">–°—É–º–º–∞</label>
                    <input type="text" class="form-input" id="transactionAmount" placeholder="0.00" inputmode="decimal" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–°—á–µ—Ç</label>
                    <select class="form-input" id="transactionAccount" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á–µ—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <div class="categories-grid categories-grid-small" id="categoriesGrid"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞</label>
                    <input type="date" class="form-input" id="transactionDate" max="" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="text" class="form-input" id="transactionComment" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π">
                </div>
                <div class="form-actions-sticky">
                    <button type="submit" class="submit-button">–°–æ–∑–¥–∞—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Transaction Edit Modal -->
    <div class="modal" id="transactionEditModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
                <button class="close-button" onclick="closeModal('transactionEditModal')">√ó</button>
            </div>
            <form id="transactionEditForm" novalidate>
                <div class="form-group">
                    <label class="form-label">–°—É–º–º–∞</label>
                    <input type="text" class="form-input" id="editTransactionAmount" placeholder="0.00" inputmode="decimal" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-input" id="editTransactionCategory" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞</label>
                    <input type="date" class="form-input" id="editTransactionDate" max="" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                    <input type="text" class="form-input" id="editTransactionComment" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π">
                </div>
                <button type="submit" class="submit-button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button type="button" class="delete-button" id="deleteTransactionBtn">–£–¥–∞–ª–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- Account Form Modal -->
    <div class="modal" id="accountModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="accountModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Å—á–µ—Ç</h2>
                <button class="close-button" onclick="closeModal('accountModal')">√ó</button>
            </div>
            <form id="accountForm" novalidate>
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="accountName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å—á–µ—Ç–∞" lang="ru" inputmode="text" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ë–∞–ª–∞–Ω—Å</label>
                    <input type="text" class="form-input" id="accountBalance" placeholder="0.00 (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" inputmode="decimal">
                </div>
                <button type="submit" class="submit-button">–°–æ–∑–¥–∞—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- Account Edit Modal -->
    <div class="modal" id="accountEditModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—á–µ—Ç</h2>
                <button class="close-button" onclick="closeModal('accountEditModal')">√ó</button>
            </div>
            <form id="accountEditForm" novalidate>
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="editAccountName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å—á–µ—Ç–∞" lang="ru" inputmode="text" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ë–∞–ª–∞–Ω—Å</label>
                    <input type="text" class="form-input" id="editAccountBalance" placeholder="0.00" inputmode="decimal" required>
                </div>
                <button type="submit" class="submit-button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button type="button" class="delete-button" id="deleteAccountBtn">–£–¥–∞–ª–∏—Ç—å —Å—á–µ—Ç</button>
            </form>
        </div>
    </div>

    <!-- Transfer Modal -->
    <div class="modal" id="transferModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏</h2>
                <button class="close-button" onclick="closeModal('transferModal')">√ó</button>
            </div>
            <form id="transferForm" novalidate>
                <div class="form-group">
                    <label class="form-label">–° –∫–∞–∫–æ–≥–æ —Å—á–µ—Ç–∞</label>
                    <select class="form-input" id="transferFromAccount" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">–ù–∞ –∫–∞–∫–æ–π —Å—á–µ—Ç</label>
                    <select class="form-input" id="transferToAccount" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">–°—É–º–º–∞</label>
                    <input type="text" class="form-input" id="transferAmount" placeholder="0.00" inputmode="decimal" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="text" class="form-input" id="transferComment" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π">
                </div>
                <button type="submit" class="submit-button">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏</button>
            </form>
        </div>
    </div>

    <!-- Transfer History Modal -->
    <div class="modal" id="transferHistoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤</h2>
                <button class="close-button" onclick="closeModal('transferHistoryModal')">√ó</button>
            </div>
            <ul class="transactions-list" id="transferHistoryList">
                <li class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</li>
            </ul>
        </div>
    </div>

    <!-- Transfer Edit Modal -->
    <div class="modal" id="transferEditModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥</h2>
                <button class="close-button" onclick="closeModal('transferEditModal')">√ó</button>
            </div>
            <form id="transferEditForm" novalidate>
                <div class="form-group">
                    <label class="form-label">–° –∫–∞–∫–æ–≥–æ —Å—á–µ—Ç–∞</label>
                    <select class="form-input" id="editTransferFromAccount" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">–ù–∞ –∫–∞–∫–æ–π —Å—á–µ—Ç</label>
                    <select class="form-input" id="editTransferToAccount" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">–°—É–º–º–∞</label>
                    <input type="text" class="form-input" id="editTransferAmount" placeholder="0.00" inputmode="decimal" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞</label>
                    <input type="date" class="form-input" id="editTransferDate" max="" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                    <input type="text" class="form-input" id="editTransferComment" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π">
                </div>
                <button type="submit" class="submit-button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button type="button" class="delete-button" id="deleteTransferBtn">–£–¥–∞–ª–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- More Categories Modal -->
    <div class="modal" id="moreCategoriesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
                <button class="close-button" onclick="closeModal('moreCategoriesModal')">√ó</button>
            </div>
            <div class="categories-grid" id="allCategoriesGrid"></div>
            <button class="action-button" id="addCategoryBtn" style="margin-top: 20px;">+ –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div class="modal" id="addCategoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h2>
                <button class="close-button" onclick="closeModal('addCategoryModal')">√ó</button>
            </div>
            <form id="addCategoryForm" novalidate>
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="categoryName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏" required>
                </div>
                <button type="submit" class="submit-button">–°–æ–∑–¥–∞—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- Alert Modal -->
    <div class="modal" id="alertModal" style="z-index: 3000;">
        <div class="modal-content" style="max-width: 280px; text-align: center; padding: 0; border-radius: 16px; overflow: hidden;">
            <div id="alertIconContainer" style="padding: 20px 20px 15px; background: linear-gradient(135deg, #0099DD 0%, #00ABBD 100%);">
                <div id="alertIcon" style="font-size: 48px; margin-bottom: 0;">‚úì</div>
            </div>
            <div style="padding: 18px 20px 20px;">
                <div id="alertMessage" style="font-size: 15px; font-weight: 600; color: #026E81; line-height: 1.4; word-wrap: break-word; margin-bottom: 18px;">–°–æ–æ–±—â–µ–Ω–∏–µ</div>
                <button type="button" class="submit-button" id="alertOkBtn" style="width: 100%; margin-top: 0; padding: 10px; font-size: 14px; border-radius: 10px; background: linear-gradient(135deg, #0099DD 0%, #00ABBD 100%); border: none; box-shadow: 0 2px 8px rgba(0, 153, 221, 0.3); cursor: pointer;">OK</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmationModal" style="z-index: 3000;">
        <div class="modal-content" style="max-width: 350px; text-align: center;">
            <div style="margin-bottom: 20px; font-size: 18px; font-weight: 600;" id="confirmationMessage">–í—ã —É–≤–µ—Ä–µ–Ω—ã?</div>
            <div style="display: flex; gap: 10px;">
                <button type="button" class="action-button" onclick="closeModal('confirmationModal')" style="background: #e0e0e0; color: #333; flex: 1;">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="delete-button" id="confirmDeleteBtn" style="margin-top: 0; flex: 1;">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <div class="toast-content">
            <span class="toast-icon">‚ö†Ô∏è</span>
            <span class="toast-message" id="toastMessage">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è</span>
        </div>
    </div>

    <script src="/webapp/assets/js/app.js"></script>
</body>
</html>
